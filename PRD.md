# 猫咪冒险游戏 PRD 文档

## 1. 产品概述

### 1.1 产品背景
- 这是一个基于 Next.js 和 TypeScript 开发的平台跳跃网页游戏
- 游戏主角是一只可爱的猫咪，玩家需要控制猫咪在花园中冒险，花园由不同颜色的乐高块平铺构成，分别代表起床、深度工作、午休、漫游、睡觉等24小时的活动，猫咪行走的路径代表了猫咪一天的生活。
- 目标：希望能将日常生活游戏化，能记录和复盘。

### 1.2 游戏关键要素
- 丰富的收集要素
- 多样的关卡设计
- 成就系统
- 自动存档功能

### 1.3 游戏视觉参考
![游戏场景参考](./concepts/概念图1.png)
*图 1.2：花园场景的视觉风格参考*

## 2. 功能需求

### 2.1 核心游戏机制

#### 2.1.1 角色控制
- 基础移动：
  - 上下左右方向键控制猫咪移动
  - 移动速度：基础速度 5 单位/帧
  - 加速度：0.5 单位/帧²
  - 最大速度：10 单位/帧
- 跳跃机制：
  - 空格键控制跳跃
  - 基础跳跃高度：15 单位
  - 重力加速度：0.8 单位/帧²
  - 二段跳高度：10 单位
- 角色能够在所有乐高块上移动


#### 2.1.2 场景设计
- 游戏场景由112个乐高块构成（尺寸默认是192x64），长8个，宽14个。为每个乐高块建立了xy轴坐标系、方便控制，以画面左上角第1个乐高块为(x1,y1)，右下角乐高块为(x8,y14)，以此类推，乐高块图片文件名称以类似"x1y1"的格式命名。
- 乐高块之间紧密相连，间距为0
- 每个乐高块都标注具体时间段（如"6-7"、"7-8"等）
- 包含两大地图区域：上方的日神时间和下方的酒神时间
    - 日神时间： 从(x1,y1)到(x8,y7)区域。代表早上6点到下午14点的时间。![场景地图](./concepts/概念图-日神时间.png)。可收集向日葵、蝴蝶、栗子。
      - 向日葵：分布在地图边缘位置
      - 蝴蝶：主要分布在上方区域
      - 栗子：分布在中间区域

    - 酒神时间： 从(x1,y8)到(x8,y14)区域。代表下午14点到次日6点的时间。![场景地图](./concepts/概念图-酒神时间.png)。可收集睡莲、鱼。
      - 睡莲：分布在底部区域
      - 鱼：分布在紫色区域

#### 2.1.3 收集机制
- 角色默认起点坐标在(x1,y7)的乐高块上方，即早上六点处。
- 收集物的坐标参考![游戏场景参考](./concepts/概念图1.png)，只要碰到物品，即收集成功，物品从地图消失
- 所有收集物位置固定，不会随机生成

### 2.2 游戏界面

#### 2.2.1 主界面布局
![主界面线框图](./concepts/游戏布局.png)
*图 2.5：主界面布局线框图*

- 顶部导航栏：
  - 游戏标题"小怪的一天"
- 游戏区域：
  - 响应式设计
  - 最小分辨率：1280x720
  - 推荐分辨率：1920x1080
- 左中右布局
  - 左侧：角色切换
    - 选择角色按钮（默认黑猫，可切换为橘猫）
    - @switch-cat-black.png：默认100%不透明度
    - @switch-cat-orange.png:默认50%透明度
    - 点击非当前角色即可切换，切换后透明度对调
    - 两个角色的移动参数完全相同
  - 中间：游戏乐高场景
    -乐高块的大小计算规则：去掉左右两侧固定宽度为中间区域宽度，8个乐高块撑满这个宽度，高度按比例自适应
  - 右侧：收集物计数"进入采集"

### 2.3 物理系统
- 实现基础的移动和跳跃检测
- 主要碰撞检测：
  - 角色与乐高块的碰撞
  - 角色与收集物的碰撞
  - 基础的跳跃动作判定

### 2.4 进阶功能（先不做）

#### 2.4.1 存档系统
- 自动保存：
  - 每完成一个区块自动保存
  - 每收集 5 个向日葵自动保存
  - 每获得一个成就自动保存
- 手动保存：
  - 在存档点手动保存
  - 最多支持 3 个存档槽
- 存档内容：
  - 玩家位置
  - 收集物状态
  - 成就进度
  - 解锁内容
  - 游戏时间


## 3. 技术规范

### 3.1 前端架构
- 框架：Next.js 15.2.4
- 语言：TypeScript 5.0+
- UI 框架：Tailwind CSS
- 状态管理：React Hooks
- 物理引擎：Matter.js
- 动画系统：Framer Motion
- 音频系统：Howler.js

### 3.2 性能要求
- 首次加载时间：< 3s
- 游戏运行帧率：> 60fps
- 内存占用：< 200MB
- 资源加载优化：
  - 图片懒加载
  - 音频按需加载
  - 代码分割
  - 资源压缩

### 3.3 代码规范
- ESLint 配置：
  - 使用 Airbnb 规范
  - 强制使用 TypeScript 严格模式
  - 强制使用 Prettier 格式化
- Git 规范：
  - 分支命名规范
  - 提交信息规范
  - 代码审查流程
- 测试规范：
  - 单元测试覆盖率 > 80%
  - 组件测试
  - 性能测试
  - 兼容性测试

## 4. 开发计划

### 4.1 第一阶段（2周）：基础功能
- [ ] 项目初始化
- [ ] 角色移动系统
- [ ] 基础碰撞检测
- [ ] 简单关卡设计
- [ ] 基础 UI 实现

### 4.2 第二阶段（2周）：游戏性增强
- [ ] 收集系统
- [ ] 成就系统
- [ ] 存档功能
- [ ] 音效系统
- [ ] 关卡完善

### 4.3 第三阶段（2周）：优化和扩展
- [ ] 性能优化
- [ ] 移动端适配
- [ ] 社交功能
- [ ] 排行榜系统
- [ ] 游戏平衡性调整

## 5. 测试计划

### 5.1 功能测试
- 角色控制测试：
  - 基础移动（上下左右）是否正常
  - 跳跃动作是否正确
  - 角色切换是否正常工作
  - 角色动画是否流畅
- 碰撞检测测试：
  - 角色与乐高块的碰撞
  - 角色与收集物的碰撞
  - 收集物消失效果
- 界面交互测试：
  - 角色切换按钮响应
  - 收集物计数显示
  - 界面布局自适应

### 5.2 性能测试
- 加载时间测试
- 帧率测试
- 内存占用测试
- 网络延迟测试
- 资源加载测试

### 5.3 兼容性测试
- 浏览器兼容性：
  - Chrome 最新版
  - Firefox 最新版
  - Safari 最新版
  - Edge 最新版
- 设备兼容性：
  - 桌面端
  - 平板端
  - 移动端
- 分辨率适配：
  - 1080p
  - 2K
  - 4K

## 6. 发布计划

### 6.1 测试版发布（1周）
- 内部测试：
  - 开发团队测试
  - 修复关键问题
- 封闭测试：
  - 邀请核心用户测试
  - 收集反馈
- 公开测试：
  - 开放注册测试
  - 数据收集分析

### 6.2 正式版发布
- 版本 1.0 发布
- 后续更新计划：
  - 每月内容更新
  - 每季度大型更新
- 运营维护计划：
  - 定期 bug 修复
  - 性能优化
  - 用户反馈处理

## 7. 附录

### 7.1 图片索引
| 图片编号 | 描述 | 路径 | 类型 |
|---------|------|------|------|
| 1.1 | 猫咪主角的视觉风格参考 | ./concepts/猫小黑.png | 概念图 |
| 1.2 | 花园场景的视觉风格参考 | ./concepts/概念图1.png | 概念图 |
| 2.1 | 角色控制示意图 | ./concepts/character_control.png | 概念图 |
| 2.2 | 特殊能力流程图 | ./concepts/special_abilities.png | 概念图 |
| 2.3 | 游戏关卡地图概览 | ./concepts/酒神时间.png | 概念图 |
| 2.4 | 关卡进程流程图 | ./concepts/level_progression.png | 概念图 |
| 2.5 | 主界面线框图 | ./images/ui/main_interface_wireframe.png | 界面图 |
| 2.6 | 游戏界面设计原型 | ./images/mockups/game_interface.png | 界面图 |

### 7.2 资源目录结构
```
src/
├── assets/                # 游戏资源
│   ├── characters/       # 角色相关资源
│   │   ├── cat/         # 猫咪角色
│   │   └── npc/         # NPC角色
│   ├── environments/     # 环境资源
│   │   ├── blocks/      # 乐高块
│   │   ├── backgrounds/ # 背景
│   │   └── props/       # 道具
│   ├── ui/              # 界面资源
│   │   ├── icons/       # 图标
│   │   └── buttons/     # 按钮
│   ├── effects/         # 特效资源
│   │   ├── particles/   # 粒子效果
│   │   └── animations/  # 动画效果
│   └── sounds/          # 音频资源
│       ├── bgm/         # 背景音乐
│       └── sfx/         # 音效
└── docs/
    └── concepts/        # 概念设计图
        ├── gameplay/    # 玩法相关
        ├── ui/          # 界面相关
        └── flowcharts/  # 流程图
```

### 7.3 资源命名规范
1. 游戏资源命名规范
   - 角色资源：`character_{角色名}_{动作}_{方向}.png`
   - 环境资源：`env_{类型}_{名称}_{状态}.png`
   - UI资源：`ui_{组件名}_{状态}.png`
   - 特效资源：`effect_{类型}_{名称}.png`
   - 音频资源：`audio_{类型}_{名称}.mp3`

2. 概念图命名规范
   - 玩法概念：`concept_gameplay_{名称}.png`
   - 界面概念：`concept_ui_{名称}.png`
   - 流程图：`flow_{功能}_{版本}.png`
   - 原型图：`